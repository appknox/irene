import CommonDRFAdapter from './commondrf';

export default class SbomScanComponentVulnerabilityAffectAdapter extends CommonDRFAdapter {
  _buildNestedURL(sbomScanComponentId: string | number) {
    const baseURL = `${this.namespace_v2}/sb_components`;

    const sbomScanComponentUrl = this.buildURLFromBase(
      `${baseURL}/${encodeURIComponent(sbomScanComponentId)}`
    );

    return `${sbomScanComponentUrl}/sb_vulnerability_audits`;
  }

  urlForQuery(query: { sbomScanComponentId: string | number }) {
    return this._buildNestedURL(query.sbomScanComponentId);
  }
}

declare module 'ember-data/types/registries/adapter' {
  export default interface AdapterRegistry {
    'sbom-scan-component-vulnerability-affect': SbomScanComponentVulnerabilityAffectAdapter;
  }
}

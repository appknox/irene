<div class='flex-column' local-class='home-page-container'>
  <ProjectList::Header
    @hasProjects={{this.hasProjects}}
    @query={{this.query}}
    @platform={{this.platform}}
    @scanType={{this.scanType}}
    @sortKey={{this.sortKey}}
    @onQueryChange={{this.onQueryChange}}
    @handleClear={{this.handleClear}}
    @filterPlatform={{this.filterPlatform}}
    @filterScanType={{this.filterScanType}}
    @onSelectTeam={{this.onSelectTeam}}
    @sortProjects={{this.sortProjects}}
    @onColumnsUpdate={{this.handleColumnsUpdate}}
    @onOpenColumnManager={{this.openColumnManager}}
  />

  {{#unless this.isCardView}}
    <ProjectList::ColumnManagerDrawer
      @open={{this.showColumnManager}}
      @allColumnsMap={{this.allColumnsMap}}
      @onClose={{this.closeColumnManager}}
      @onApply={{this.handleColumnsUpdate}}
    />
  {{/unless}}

  {{#if this.hasProjects}}
    <div>
      {{#if this.isLoading}}
        <div class='flex-row flex-justify-center'>
          <ProjectList::Loader
            @loadingText='{{t "loading"}}...'
            data-test-fileList-loadingContainer
          />
        </div>
      {{else if this.showProjectResults}}
        <AkPaginationProvider
          @results={{this.projects}}
          @onItemPerPageChange={{this.handleItemPerPageChange}}
          @totalItems={{this.totalProjectCount}}
          @nextAction={{this.handlePrevNextAction}}
          @prevAction={{this.handlePrevNextAction}}
          @itemPerPageOptions={{array 12 24 48}}
          @defaultLimit={{this.limit}}
          @offset={{this.offset}}
          as |pgc|
        >
          {{#if this.isCardView}}
            <div local-class='project-grid'>
              {{#each pgc.currentPageResults as |project|}}
                <ProjectOverview
                  data-test-cy='project-overview-{{project.lastFile.id}}'
                  @project={{project}}
                />
              {{/each}}
            </div>
          {{else}}
            <AkStack @width='full' {{style overflowX='auto'}}>
              <AkTable
                local-class='project-table'
                @dense={{true}}
                @hoverable={{true}}
                data-test-project-list-table
                as |t|
              >
                <t.head
                  @columns={{this.columns}}
                  @scrollIndicators='horizontal'
                  data-test-project-list-column-header
                />

                <t.body @rows={{pgc.currentPageResults}} as |b|>
                  <b.row
                    {{style cursor='pointer'}}
                    @onClick={{fn this.handleProjectRowClick b.rowValue}}
                    data-test-project-list-table-row
                    as |r|
                  >
                    <r.cell as |value|>
                      {{#if r.columnValue.component}}
                        {{#let
                          (component r.columnValue.component)
                          as |Component|
                        }}
                          <Component @project={{r.rowValue}} />
                        {{/let}}
                      {{else}}
                        <AkTypography
                          data-test-project-list-table-row-value
                          @noWrap={{true}}
                          title={{value}}
                        >
                          {{value}}
                        </AkTypography>
                      {{/if}}
                    </r.cell>
                  </b.row>
                </t.body>
              </AkTable>
            </AkStack>
          {{/if}}

          {{#if this.showPagination}}
            <AkPagination
              @disableNext={{pgc.disableNext}}
              @nextAction={{pgc.nextAction}}
              @disablePrev={{pgc.disablePrev}}
              @prevAction={{pgc.prevAction}}
              @endItemIdx={{pgc.endItemIdx}}
              @startItemIdx={{pgc.startItemIdx}}
              @itemPerPageOptions={{pgc.itemPerPageOptions}}
              @onItemPerPageChange={{pgc.onItemPerPageChange}}
              @selectedOption={{pgc.selectedOption}}
              @tableItemLabel={{t 'projects'}}
              @perPageTranslation={{t 'recordPerPage'}}
              @totalItems={{pgc.totalItems}}
            />
          {{/if}}
        </AkPaginationProvider>
      {{else if this.hasNoProjects}}
        <AkStack
          local-class='no-project-container'
          @alignItems='center'
          @justifyContent='center'
          @direction='column'
        >
          <AkSvg::ProjectListEmpty />

          <AkTypography @variant='h4' @fontWeight='bold' class='pt-3 pb-1'>
            {{t 'noResultsFound'}}
          </AkTypography>

          <AkTypography @variant='h5' @fontWeight='regular' @align='center'>
            {{t 'tryAdjustingFilter'}}
          </AkTypography>

        </AkStack>
      {{else}}
        <div class='flex-row flex-justify-center'>
          <ProjectList::Loader @loadingText='{{t "loading"}}...' />
        </div>
      {{/if}}
    </div>
  {{else}}
    <AkStack
      local-class='no-project-container'
      @alignItems='center'
      @justifyContent='center'
      @direction='column'
      data-test-no-project-container
    >
      <AkSvg::ProjectListEmpty />

      <AkTypography
        @variant='h4'
        @fontWeight='bold'
        class='pt-3 pb-1'
        data-test-no-project-header
      >
        {{t 'uploadAnApp'}}
      </AkTypography>

      <AkTypography
        @variant='h5'
        @fontWeight='regular'
        @align='center'
        data-test-no-project-text
      >
        {{t 'noProjectExists'}}
      </AkTypography>
    </AkStack>
  {{/if}}
</div>
<AkStack
  local-class='vulnerability-header'
  @alignItems='center'
  @justifyContent='space-between'
>
  <AkStack @direction='column' @spacing='0.5'>
    <AkTypography data-test-vulnerability-analysis-title @variant='h5'>
      {{t 'vulnerabilityDetails'}}
    </AkTypography>

    <AkTypography
      data-test-vulnerability-analysis-description
      @variant='body2'
      @color='textSecondary'
    >
      {{t 'fileVulnerabilityDetailsDescription'}}
    </AkTypography>
  </AkStack>

  <AkStack @spacing='1.5'>
    {{#if this.isSecurityEnabled}}
      <AkButton
        @tag='a'
        href='/security/file/{{@file.id}}'
        target='_blank'
        rel='noopener noreferrer'
        data-test-vulnerability-analysis-editAnalysesLink
      >
        <:leftIcon>
          <AkIcon @iconName='edit' />
        </:leftIcon>

        <:default>
          <AkTypography @tag='span' @color='inherit' @noWrap={{true}}>
            {{t 'editAnalyses'}}
          </AkTypography>
        </:default>
      </AkButton>
    {{/if}}

    <div {{style width='120px'}}>
      <AkSelect
        data-test-vulnerability-analysis-filterSelect
        @onChange={{@setVulnerabilityType}}
        @options={{this.vulnerabilityTypes}}
        @selected={{@filterVulnerabilityType}}
        @triggerClass={{this.classes.vulnerabilityTypeFilterSelectTrigger}}
        as |aks|
      >
        {{#if (eq aks -1)}}
          {{t 'allScans'}}
        {{else}}
          {{t (vulnerability-type aks)}}
        {{/if}}
      </AkSelect>
    </div>
  </AkStack>
</AkStack>
import { action } from '@ember/object';
import Component from '@glimmer/component';
import { tracked } from '@glimmer/tracking';

import Nistsp800171Model from 'irene/models/nistsp800171';
import Nistsp80053Model from 'irene/models/nistsp80053';

export interface FileDetailsVulnerabilityAnalysisDetailsRegulatoryContentNistSignature {
  Args: {
    contents: (Nistsp800171Model | Nistsp80053Model)[];
  };
}

export default class FileDetailsVulnerabilityAnalysisDetailsRegulatoryContentNistComponent extends Component<FileDetailsVulnerabilityAnalysisDetailsRegulatoryContentNistSignature> {
  @tracked nistContentOverflowMap: Record<string, boolean> = {};

  @action
  checkOverflow(element: HTMLElement, [id]: [string]) {
    const hasOverflow =
      element.offsetHeight < element.scrollHeight ||
      element.offsetWidth < element.scrollWidth;

    this.nistContentOverflowMap = {
      ...this.nistContentOverflowMap,
      [id]: hasOverflow,
    };
  }
}

declare module '@glint/environment-ember-loose/registry' {
  export default interface Registry {
    'file-details/vulnerability-analysis-details/regulatory-content/nist': typeof FileDetailsVulnerabilityAnalysisDetailsRegulatoryContentNistComponent;
  }
}

<div class='px-4 py-2'>
    <AkStack @direction='column'>
        {{#each this.currentVulnerabilityDetails as |item|}}
          {{#if item.value}}
            <AkStack @width='full' class='mb-1'>
              <AkStack @width='4/12'>
                <AkTypography
                  data-test-analysisDetails-vulFindingLabel='{{item.label}}'
                  @color='textSecondary'
                >
                  {{item.label}}
                </AkTypography>
              </AkStack>

              <AkStack @width='9/12'>
                <AkTypography
                  data-test-analysisDetails-vulFindingValue
                  @fontWeight='medium'
                >
                  {{item.value}}
                </AkTypography>
              </AkStack>
            </AkStack>
          {{/if}}
        {{/each}}

        {{#if @currentVulnerability.request.body}}
          {{#unless this.isRequestBodyEmpty}}
            <AkTypography @color='textSecondary'>
              {{t 'requestBody'}}:
            </AkTypography>

            <div local-class='vulnerability-finding-container'>
              <pre local-class='vulnerability-finding-description'>
                {{@currentVulnerability.request.body}}
              </pre>
            </div>
          {{/unless}}
        {{/if}}

        {{#unless this.isRequestHeadersEmpty}}
          <FileDetails::VulnerabilityAnalysisDetails::Findings::CodeBox
            @title={{t 'requestHeaders'}}
            @copyIcon={{true}}
            @markedAsPassed={{@analysis.isOverriddenAsPassed}}
          >{{#each-in
              @currentVulnerability.request.headers
              as |key value|
            }}<span>{{key}}: {{value}}</span>
            {{/each-in}}
          </FileDetails::VulnerabilityAnalysisDetails::Findings::CodeBox>
        {{/unless}}

        {{#unless this.isRequestParamsEmpty}}
          <FileDetails::VulnerabilityAnalysisDetails::Findings::CodeBox
            @title={{t 'requestParameters'}}
            @copyIcon={{true}}
            @markedAsPassed={{@analysis.isOverriddenAsPassed}}
          >{{this.requestParamsKey}}<br />{{this.requestParamsToken}}
          </FileDetails::VulnerabilityAnalysisDetails::Findings::CodeBox>
        {{/unless}}

        {{#if @currentVulnerability.response.status_code}}
          <FileDetails::VulnerabilityAnalysisDetails::Findings::CodeBox
            @title={{t 'response'}}
            @markedAsPassed={{@analysis.isOverriddenAsPassed}}
          >{{this.responseStatusCode}}<br />{{this.responseMessage}}
          </FileDetails::VulnerabilityAnalysisDetails::Findings::CodeBox>
        {{/if}}

        {{#unless this.isResponseHeadersEmpty}}
          <FileDetails::VulnerabilityAnalysisDetails::Findings::CodeBox
            @title={{t 'responseHeaders'}}
            @copyIcon={{true}}
            @markedAsPassed={{@analysis.isOverriddenAsPassed}}
          >{{#each-in
              @currentVulnerability.response.headers
              as |key value|
            }}<span>{{key}}: {{value}}</span>
            {{/each-in}}
          </FileDetails::VulnerabilityAnalysisDetails::Findings::CodeBox>
        {{/unless}}
    </AkStack>
</div>
<div ...attributes class='py-2'>
  {{#each this.currentVulnerabilityDetails as |item|}}
    {{#if item.value}}
      <AkStack @width='full' class='mb-1 px-4'>
        <AkTypography
          data-test-analysisDetails-vulFindingLabel='{{item.label}}'
          class='w-4/12'
          @color='textSecondary'
        >
          {{item.label}}
        </AkTypography>

        <AkTypography
          data-test-analysisDetails-vulFindingValue
          {{style word-break='break-all'}}
          class='w-9/12'
          @fontWeight='medium'
        >
          {{item.value}}
        </AkTypography>
      </AkStack>
    {{/if}}
  {{/each}}

  {{#if this.cvssScore}}
    <AkDivider class='my-2' @color='dark' />

    <AkStack @width='full' class='mb-1 px-4'>
      <AkTypography
        data-test-analysisDetails-vulFindingCvssLabel
        class='w-4/12'
        @color='textSecondary'
      >
        {{t 'cvssV3'}}
      </AkTypography>

      <AkTypography
        data-test-analysisDetails-vulFindingCvssValue
        class='w-9/12'
        @fontWeight='medium'
      >
        {{this.cvssScore}}
      </AkTypography>
    </AkStack>
  {{/if}}

  {{#if this.hasCvssMetrics}}
    <AkDivider class='my-2' @color='dark' />

    <AkTypography
      data-test-analysisDetails-vulFindingCvssMetricsLabel
      @fontWeight='medium'
      class='px-4'
    >
      {{t 'cvssMetrics'}}
    </AkTypography>

    <AkDivider class='my-2' @color='dark' />

    {{#each this.cvssMetrics as |metric|}}
      <AkStack
        data-test-analysisDetails-vulFindingCvssMetric='{{metric.key}}'
        @width='full'
        class='mb-1 px-4'
      >
        <AkTypography
          data-test-analysisDetails-vulFindingCvssMetricLabel
          class='w-4/12'
          @color='textSecondary'
        >
          {{metric.key}}
        </AkTypography>

        <AkTypography
          data-test-analysisDetails-vulFindingCvssMetricValue
          class='w-9/12'
          @fontWeight='medium'
        >
          {{metric.value}}
        </AkTypography>
      </AkStack>
    {{/each}}
  {{/if}}

  {{#each this.vulnerabilityDetails as |detail idx|}}
    {{#if (eq idx 0)}}
      <AkDivider class='mt-4 mb-2' @color='dark' />
    {{/if}}

    <div class='px-4 py-2'>
      {{#let
        (component
          'file-details/vulnerability-analysis-details/findings/code-box'
          title=detail.title
          copyIcon=detail.copyIcon
          markedAsPassed=@analysis.isOverriddenAsPassed
        )
        as |CodeBox|
      }}
        {{#if detail.isKeyValuePair}}
          {{! Note: formating will add a new line for each key value pair }}
          <CodeBox>{{#each-in detail.value as |key value|}}<span>{{key}}:
                {{value}}</span>
            {{/each-in}}
          </CodeBox>
        {{else}}
          <CodeBox>{{detail.value}}</CodeBox>
        {{/if}}
      {{/let}}
    </div>
  {{/each}}
</div>
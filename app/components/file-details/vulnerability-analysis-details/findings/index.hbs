{{#if this.hasVulnerableApiFinding}}
  <div
    local-class='analysis-section {{if
      @analysis.isOverriddenAsPassed
      "analysis-overridden-passed"
    }}'
    class='mb-2'
    data-test-analysisDetails-vulnerabilityContainer
  >
    <AkPaginationProvider
      @results={{this.currentVulnerableApiFindings}}
      @onItemPerPageChange={{this.noop}}
      @totalItems={{this.totalVulnerableApiFindings}}
      @nextAction={{this.handlePrevNextClick}}
      @prevAction={{this.handlePrevNextClick}}
      @itemPerPageOptions={{array 1}}
      @defaultLimit={{this.limit}}
      @offset={{this.offset}}
      as |pgc|
    >
      <AkStack
        @alignItems='center'
        @justifyContent='space-between'
        local-class='analysis-content-title'
      >
        <AkTypography
          data-test-analysisDetails-vulnerabilityTitle
          @variant='subtitle1'
          @gutterBottom={{true}}
        >
          {{t 'vulnerableApis'}}
        </AkTypography>

        <AkStack @spacing='1.5' @alignItems='center'>
          <AkStack
            local-class='counter-container'
            @spacing='3'
            @alignItems='center'
          >
            <AkIconButton
              data-test-analysisDetails-vulFinding-pagination-prevBtn
              disabled={{pgc.disablePrev}}
              local-class='ak-pagination-prev-button'
              {{on 'click' pgc.prevAction}}
            >
              <AkIcon
                @iconName='arrow-left'
                {{style fontSize='1.28rem !important'}}
              />
            </AkIconButton>

            <AkStack @spacing='0.5' @alignItems='center'>
              <AkTypography @variant='subtitle1'>
                {{pgc.startItemIdx}}
              </AkTypography>
              <AkTypography @variant='body2'>
                {{t 'outOf'}}
              </AkTypography>
              <AkTypography @variant='subtitle1'>
                {{pgc.totalItems}}
                {{t 'apis'}}
              </AkTypography>
            </AkStack>

            <AkIconButton
              data-test-analysisDetails-vulFinding-pagination-nextBtn
              disabled={{pgc.disableNext}}
              local-class='ak-pagination-next-button'
              {{on 'click' pgc.nextAction}}
            >
              <AkIcon
                @iconName='arrow-right'
                {{style fontSize='1.28rem !important'}}
              />
            </AkIconButton>
          </AkStack>

          <AkDivider @direction='vertical' @height='30px' @color='dark' />

          <AkTooltip
            @arrow={{true}}
            @placement='bottom'
            @title={{t 'downloadRawApiFindings'}}
          >
            <AkIconButton
              {{on 'click' (perform this.downloadApiFindingsPayload)}}
              @variant='outlined'
            >
              <AkIcon @iconName='download' />
            </AkIconButton>
          </AkTooltip>
        </AkStack>
      </AkStack>

      <FileDetails::VulnerabilityAnalysisDetails::Findings::VulnerableApi
        local-class='analysis-content-container'
        @currentVulnerability={{get pgc.currentPageResults 0}}
        @analysis={{this.analysis}}
      />
    </AkPaginationProvider>
  </div>
{{/if}}

{{#if this.hasCustomVulnerableFinding}}
  <FileDetails::VulnerabilityAnalysisDetails::Findings::CustomVulnerabilities
    @customVulnerableFindings={{this.customVulnerableFindings}}
    @analysis={{this.analysis}}
  />
{{/if}}
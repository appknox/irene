{{#if this.hasVulnerableApiFinding}}
  <div
    local-class='analysis-section {{if
      @analysis.isOverriddenAsPassed
      "analysis-overridded-passed"
    }}'
    class='mb-2'
    data-test-analysisDetails-vulnerabilityContainer
  >
    <AkPaginationProvider
      @results={{this.currentVulnerableApiFindings}}
      @onItemPerPageChange={{this.noop}}
      @totalItems={{this.totalVulnerableApiFindings}}
      @nextAction={{this.handlePrevNextClick}}
      @prevAction={{this.handlePrevNextClick}}
      @itemPerPageOptions={{array 1}}
      @defaultLimit={{this.limit}}
      @offset={{this.offset}}
      as |pgc|
    >
      <AkStack
        @alignItems='center'
        @justifyContent='space-between'
        local-class='analysis-content-title'
      >
        <AkTypography
          data-test-analysisDetails-vulnerabilityTitle
          @variant='subtitle1'
          @gutterBottom={{true}}
        >
          {{t 'vulnerableApis'}}
        </AkTypography>

        <AkStack @spacing='1' @alignItems='center'>
          <AkStack
            local-class='counter-container'
            @spacing='0.5'
            @alignItems='flex-end'
          >
            <AkTypography @variant='subtitle1'>
              {{pgc.startItemIdx}}
            </AkTypography>
            <AkTypography @variant='body2'>
              out of
            </AkTypography>
            <AkTypography @variant='subtitle1'>
              {{pgc.totalItems}}
              APIs'
            </AkTypography>
          </AkStack>

          <AkButton
            data-test-analysisDetails-vulFinding-pagination-prevBtn
            @disabled={{pgc.disablePrev}}
            @leftIconClass={{this.classes.prevButtonIconClass}}
            @color='neutral'
            @variant='outlined'
            local-class='ak-pagination-prev-button'
            {{on 'click' pgc.prevAction}}
          >
            <:leftIcon>
              <AkIcon
                @iconName='arrow-left'
                {{style fontSize='1.28rem !important'}}
              />
            </:leftIcon>

            <:default>
              {{t 'previous'}}
            </:default>
          </AkButton>

          <AkButton
            data-test-analysisDetails-vulFinding-pagination-nextBtn
            @disabled={{pgc.disableNext}}
            @color='neutral'
            @variant='outlined'
            @rightIconClass={{this.classes.nextButtonIconClass}}
            local-class='ak-pagination-next-button'
            {{on 'click' pgc.nextAction}}
          >
            <:default>
              {{t 'next'}}
            </:default>

            <:rightIcon>
              <AkIcon
                @iconName='arrow-right'
                {{style fontSize='1.28rem !important'}}
              />
            </:rightIcon>
          </AkButton>
        </AkStack>
      </AkStack>

      <FileDetails::VulnerabilityAnalysisDetails::Findings::VulnerableApi
        @currentVulnerability={{get pgc.currentPageResults 0}}
        @analysis={{this.analysis}}
      />
    </AkPaginationProvider>
  </div>
{{/if}}

{{#if this.hasCustomVulnerableFinding}}
  <FileDetails::VulnerabilityAnalysisDetails::Findings::CustomVulnerabilities
    @customVulnerableFindings={{this.customVulnerableFindings}}
    @analysis={{this.analysis}}
  />
{{/if}}